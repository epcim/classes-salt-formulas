classes:
- bind.server.single
parameters:
  _param:
    mgmt_allow_node01_address: ${_param:openstack_control_node01_address}
    mgmt_allow_node02_address: ${_param:openstack_control_node02_address}
    mgmt_allow_node03_address: ${_param:openstack_control_node03_address}
  bind:
    server:
      key:
        mgmt:
          secret: "${_param:bind9_mgmt_rndc_key}"
          algorithm: "${_param:bind9_mgmt_rndc_algorithm}"
      allow_new_zones: true
      query: true
      # for local server management /etc/bind/rndc.key
      # generated by bind9 package postinstall script
      # will be used
      control:
        local:
          enabled: true
          bind:
            address: 127.0.0.1
            port: 953
          allow:
            - 127.0.0.1
        mgmt:
          enabled: true
          bind:
            address: ${_param:single_address}
            port: 953
          allow:
            - ${_param:mgmt_allow_node01_address}
            - ${_param:mgmt_allow_node02_address}
            - ${_param:mgmt_allow_node03_address}
          keys:
            - mgmt